var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,c=(t,a,i)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[a]=i,l=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&c(e,a,t[a]);if(i)for(var a of i(t))s.call(t,a)&&c(e,a,t[a]);return e},n=(e,i)=>t(e,a(i));import{m as o,f as u,r as p,n as d,o as h,g as m,h as b,w as f,p as g,F as y,i as v,q as T,t as C,j as _}from"./vendor.0935d5ab.js";import{_ as I}from"./TopicItem.4f93b36c.js";import"./index.e7d4a062.js";const k={name:"Form",components:{TopicItem:I},computed:n(l(l({},o("appShell",["baseInfo"])),o("topic",["cateList","topicData"])),{tabItems(){return[{title:"全部",_id:""}].concat(this.cateList)}}),data:()=>({activeName:"0",isLoadingTab:!1,currentTabId:"",currentPage:1,tab:null}),methods:n(l({},u("topic",["fetchArticlesList","fetchTopicCate"])),{handleCurrentChange(e){this.currentPage=e,this.fetchArticles()},handleClick(){this.changeTabHandle(this.activeName)},submit(){this.$refs.form.validate()&&this.createArticle(this.createForm)},fetchArticles(){let e={query:{type:2},options:{limit:5,page:this.currentPage,sort:{date:-1},populate:"user cat"}};return this.currentTabId&&(e.query.cat=this.currentTabId),this.fetchArticlesList(e)},changeTabHandle(e){this.isLoadingTab||e!=this.currentTabId&&(this.currentTabId=e,this.currentPage=1,this.isLoadingTab=!0,this.fetchArticles().then((()=>{this.isLoadingTab=!1})))}}),mounted(){this.cateList.length||this.fetchTopicCate({query:{type:2}}),this.fetchArticles()}},j={class:"forum-wrapper"},D={key:0},L=b("div",{class:"card-header"},[b("span",null,"个人信息")],-1),P={class:"flex items-center mb-8"},O={class:"text-overflow"},w=_("发布主题"),x=_("新建类目");k.render=function(e,t,a,i,r,s){const c=p("el-tab-pane"),l=p("el-tabs"),n=p("topic-item"),o=p("el-divider"),u=p("el-pagination"),_=p("el-card"),I=p("el-col"),k=p("el-avatar"),A=p("el-button"),q=p("el-row"),N=d("loading");return h(),m("div",j,[b(q,{gutter:20},{default:f((()=>[b(I,{span:18},{default:f((()=>[g(b(_,null,{default:f((()=>[b(l,{modelValue:r.activeName,"onUpdate:modelValue":t[1]||(t[1]=e=>r.activeName=e),onTabClick:s.handleClick,class:"forum-tabs"},{default:f((()=>[(h(!0),m(y,null,v(s.tabItems,(e=>(h(),m(c,{key:e._id,label:e.title,name:e._id},null,8,["label","name"])))),128))])),_:1},8,["modelValue","onTabClick"]),e.topicData&&e.topicData.docs?g((h(),m("div",D,[(h(!0),m(y,null,v(e.topicData.docs,((t,a)=>(h(),m(y,{key:t._id+a},[b(n,{topic:t},null,8,["topic"]),a<e.topicData.docs.length-1?(h(),m(o,{key:0})):T("",!0)],64)))),128)),b(u,{class:"mt-8 text-center",background:"","current-page":r.currentPage,"page-size":e.topicData.limit,layout:"prev, pager, next",onCurrentChange:s.handleCurrentChange,total:e.topicData.totalDocs},null,8,["current-page","page-size","onCurrentChange","total"])],512)),[[N,r.isLoadingTab]]):T("",!0)])),_:1},512),[[N,!e.topicData]])])),_:1}),b(I,{span:6},{default:f((()=>[b(_,{class:"box-card"},{header:f((()=>[L])),default:f((()=>[b("div",P,[b(k,{class:"mr-4",icon:"el-icon-user-solid"}),b("span",O,C(e.baseInfo.email),1)]),b("div",null,[b(A,{type:"success",onClick:t[2]||(t[2]=t=>e.$router.push({name:"createTopic"}))},{default:f((()=>[w])),_:1}),b(A,{type:"success",onClick:t[3]||(t[3]=t=>e.$router.push({name:"topicCate"}))},{default:f((()=>[x])),_:1})])])),_:1})])),_:1})])),_:1})])};export default k;
