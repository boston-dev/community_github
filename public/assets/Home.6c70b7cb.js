var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,i=(t,a,o)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o,n=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&i(e,a,t[a]);if(o)for(var a of o(t))s.call(t,a)&&i(e,a,t[a]);return e},l=(e,o)=>t(e,a(o));import{_ as c}from"./TopicItem.d08e4fac.js";import{m as p,f as d,r as u,n as h,o as m,g,p as f,h as y,w as v,F as D,i as b,q as P,t as _}from"./vendor.fd304484.js";import"./index.e7d4a062.js";const j={name:"Home",components:{TopicItem:c},data:()=>({currentPage:1,loading:!1}),computed:l(n({},p("topic",["homeData"])),{topic(){return{query:{type:2},options:{limit:5,page:this.currentPage,populate:"user",sort:{date:-1}}}}}),methods:l(n({},d("topic",["fetchHomeData"])),{async getHome(e){this.loading=!0,await this.fetchHomeData(e),this.loading=!1},handleCurrentChange(e){this.currentPage=e,this.getHome({topic:this.topic})}}),created(){if(this.homeData.topic.totalPages)return this.currentPage=this.homeData.topic.page,!1;this.getHome({topic:this.topic,user:{query:[{$match:{user:{$exists:!0}}},{$group:{_id:"$user",count:{$sum:1}}},{$sort:{count:-1}},{$limit:10}]}})}},w={class:"home-wrapper"},O=y("div",{class:"card-header"},[y("span",null,"论坛")],-1),C=y("div",{class:"card-header"},[y("span",null,"文档")],-1),k=y("div",{class:"card-header"},[y("span",null,"热门作者")],-1),x={class:"flex items-center"},$={class:"text-overflow"};j.render=function(e,t,a,o,r,s){const i=u("TopicItem"),n=u("el-divider"),l=u("el-pagination"),c=u("el-empty"),p=u("el-card"),d=u("el-col"),j=u("el-avatar"),H=u("el-row"),I=h("loading");return m(),g("div",w,[f(y(H,{gutter:20},{default:v((()=>[y(d,{span:18},{default:v((()=>[y(p,null,{header:v((()=>[O])),default:v((()=>[(m(!0),g(D,null,b(e.homeData.topic.docs,((t,a)=>(m(),g("div",{key:t._id},[y(i,{topic:t},null,8,["topic"]),a<e.homeData.topic.docs.length-1?(m(),g(n,{key:0})):P("",!0)])))),128)),y(l,{class:"mt-8 text-center",background:"","current-page":r.currentPage,"page-size":s.topic.options.limit,layout:"prev, pager, next",onCurrentChange:s.handleCurrentChange,total:e.homeData.topic.totalDocs||0},null,8,["current-page","page-size","onCurrentChange","total"]),e.homeData.topic.docs.length?P("",!0):(m(),g(c,{key:0,description:"暂无数据"}))])),_:1}),y(p,{class:"mt-4"},{header:v((()=>[C])),default:v((()=>[y(c,{description:"暂无数据"})])),_:1})])),_:1}),y(d,{span:6},{default:v((()=>[y(p,null,{header:v((()=>[k])),default:v((()=>[(m(!0),g(D,null,b(e.homeData.user,((t,a)=>(m(),g("div",{key:t._id},[y("div",x,[y(j,{class:"mr-4",icon:"el-icon-user-solid"}),y("span",$,_(t.email),1)]),a<e.homeData.user.length-1?(m(),g(n,{key:0})):P("",!0)])))),128)),e.homeData.user.length?P("",!0):(m(),g(c,{key:0,description:"暂无数据"}))])),_:1})])),_:1})])),_:1},512),[[I,r.loading]])])};export default j;
