var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(t,r,a)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,c=(e,t)=>{for(var r in t||(t={}))l.call(t,r)&&s(e,r,t[r]);if(a)for(var r of a(t))o.call(t,r)&&s(e,r,t[r]);return e};import{m as i,f as d,r as m,o as n,g as u,h as p,w as f,F as h,i as b,j as g}from"./vendor.0935d5ab.js";import{_ as y}from"./MyEditor.890d3bcb.js";const F={name:"createDocument",components:{MyEditor:y},computed:c(c({},i("appShell",["baseInfo"])),i("topic",["cateList"])),data:()=>({valid:!0,createForm:{cat:"",title:"",cont:"666",pic:"",type:3},rules:{cat:[{required:!0,message:"请选择模块",trigger:"change"}],title:[{required:!0,message:"请输入文档标题",trigger:"blur"}],cont:[{required:!0,message:"请输入主题内容",trigger:"change"}]}}),created(){this.fetchTopicCate({query:{type:3}})},methods:(v=c({},d("topic",["fetchTopicCate","fetchArticlesList","createArticle"])),j={handleUploadImage(e,t,r){console.log(r);let a=new FormData;a.append("file",r[0]),this.$request.post("/users/upload",a).then((e=>{if(200==!e.data.code)return this.$message(e.data.msg),!1;t({url:e.data.result.src})}))},submitForm(e){this.$refs[e].validate((e=>{if(e){let e=this.$refs.myEditor.engine;this.createForm.cont=e.getHtml(),this.createArticle(this.createForm).then((e=>{200==e.code&&(this.$message.success(e.msg),setTimeout((()=>{this.$router.replace({name:"documentsDetail",params:{id:e.result._id}})}),1500))}))}}))}},t(v,r(j))),mounted(){console.log("mounted",this.$refs.myEditor)}};var v,j;const O={class:"document-wrapper"},_=p("div",{class:"card-header"},[p("span",null,"发布文档")],-1),w=g("发布");F.render=function(e,t,r,a,l,o){const s=m("el-option"),c=m("el-select"),i=m("el-form-item"),d=m("el-input"),g=m("my-editor"),y=m("el-button"),F=m("el-form"),v=m("el-card");return n(),u("div",O,[p(v,{class:"box-card"},{header:f((()=>[_])),default:f((()=>[p(F,{model:l.createForm,rules:l.rules,ref:"createForm","label-width":"100px",class:"demo-createForm"},{default:f((()=>[p(i,{label:"选择板块",prop:"cat"},{default:f((()=>[p(c,{modelValue:l.createForm.cat,"onUpdate:modelValue":t[1]||(t[1]=e=>l.createForm.cat=e),placeholder:"请选择模块"},{default:f((()=>[(n(!0),u(h,null,b(e.cateList,((e,t)=>(n(),u(s,{key:t,label:e.title,value:e._id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(i,{label:"文档标题",prop:"title"},{default:f((()=>[p(d,{modelValue:l.createForm.title,"onUpdate:modelValue":t[2]||(t[2]=e=>l.createForm.title=e)},null,8,["modelValue"])])),_:1}),p(g,{ref:"myEditor"},null,512),p(i),p(y,{type:"primary",onClick:t[3]||(t[3]=e=>o.submitForm("createForm"))},{default:f((()=>[w])),_:1})])),_:1},8,["model","rules"])])),_:1})])};export default F;
